#include <stdio.h>
#include <stdlib.h>

typedef struct Cvor {
    int podatak;
    struct Cvor* levo;
    struct Cvor* desno;
} Cvor;
 
Cvor* napraviCvor(int x) {
    Cvor* novi = (Cvor*)malloc(sizeof(Cvor));
    novi->podatak = x;
    novi->levo = NULL;
    novi->desno = NULL;
    return novi;
}

Cvor* ubaci(Cvor* koren, int x) {
    if (koren == NULL)
        return napraviCvor(x);

    if (x < koren->podatak)
        koren->levo = ubaci(koren->levo, x);
    else if (x > koren->podatak)
        koren->desno = ubaci(koren->desno, x);

    return koren;
}

Cvor* pretrazi(Cvor* koren, int x) {
    if (koren == NULL || koren->podatak == x)
        return koren;

    if (x < koren->podatak)
        return pretrazi(koren->levo, x);
    else
        return pretrazi(koren->desno, x);
}

Cvor* minimum(Cvor* koren) {
    while (koren->levo != NULL)
        koren = koren->levo;
    return koren;
}

Cvor* obrisi(Cvor* koren, int x) {
    if (koren == NULL)
        return koren;

    if (x < koren->podatak)
        koren->levo = obrisi(koren->levo, x);
    else if (x > koren->podatak)
        koren->desno = obrisi(koren->desno, x);
    else {
        if (koren->levo == NULL) {
            Cvor* temp = koren->desno;
            free(koren);
            return temp;
        }
        else if (koren->desno == NULL) {
            Cvor* temp = koren->levo;
            free(koren);
            return temp;
        }

        Cvor* temp = minimum(koren->desno);
        koren->podatak = temp->podatak;
        koren->desno = obrisi(koren->desno, temp->podatak);
    }
    return koren;
}

void inorder(Cvor* koren) {
    if (koren != NULL) {
        inorder(koren->levo);
        printf("%d ", koren->podatak);
        inorder(koren->desno);
    }
}

void preorder(Cvor* koren) {
    if (koren != NULL) {
        printf("%d ", koren->podatak);
        preorder(koren->levo);
        preorder(koren->desno);
    }
}

void postorder(Cvor* koren) {
    if (koren != NULL) {
        postorder(koren->levo);
        postorder(koren->desno);
        printf("%d ", koren->podatak);
    }
}

int visina(Cvor* koren) {
    if (koren == NULL)
        return 0;

    int l = visina(koren->levo);
    int d = visina(koren->desno);

    return (l > d ? l : d) + 1;
}

int brojElemenata(Cvor* koren) {
    if (koren == NULL)
        return 0;
    return 1 + brojElemenata(koren->levo) + brojElemenata(koren->desno);
}

void meni() {
    printf("\n--- MENI ---\n");
    printf("1. Unos elementa\n");
    printf("2. Brisanje elementa\n");
    printf("3. Pretraga elementa\n");
    printf("4. Inorder obilazak\n");
    printf("5. Preorder obilazak\n");
    printf("6. Postorder obilazak\n");
    printf("7. Visina stabla\n");
    printf("8. Broj elemenata\n");
    printf("0. Izlaz\n");
}

int main() {
    Cvor* koren = NULL;
    int izbor, x;

    do {
        meni();
        printf("Izbor: ");
        scanf("%d", &izbor);

        switch (izbor) {
        case 1:
            printf("Unesite element: ");
            scanf("%d", &x);
            koren = ubaci(koren, x);
            break;

        case 2:
            printf("Unesite element za brisanje: ");
            scanf("%d", &x);
            koren = obrisi(koren, x);
            break;

        case 3:
            printf("Unesite element za pretragu: ");
            scanf("%d", &x);
            if (pretrazi(koren, x))
                printf("Element postoji u stablu.\n");
            else
                printf("Element ne postoji.\n");
            break;

        case 4:
            inorder(koren);
            printf("\n");
            break;

        case 5:
            preorder(koren);
            printf("\n");
            break;

        case 6:
            postorder(koren);
            printf("\n");
            break;

        case 7:
            printf("Visina stabla: %d\n", visina(koren));
            break;

        case 8:
            printf("Broj elemenata: %d\n", brojElemenata(koren));
            break;
        }
    } while (izbor != 0);

    return 0;
}